name: Testing with Codeception
on:
  pull_request:
    branches: [ master, develop ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Install composer packages
        uses: php-actions/composer@v6
        with:
          version: 2
          php_version: 8.0
          php_extensions: openssl bcmath
          interaction: yes
          progress: yes
          
          
      - name: Create .env File
        run: ls -ls

      - name: Shutdown Ubuntu MySQL (SUDO)
        run: sudo service mysql stop
        
      - name: Set up MariaDB
        uses: getong/mariadb-action@v1.1
        with:
          mysql database: 'iol_sso'
          mysql root password: 'test'
          
      - name: Import DB
        run: mysql --user='root' --password='test' iol_sso < ./sql/dump.sql

      - name: Test project
        run: echo "test"
